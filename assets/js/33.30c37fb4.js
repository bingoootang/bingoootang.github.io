(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{288:function(t,a,e){"use strict";e.r(a);var n=e(4),s=Object(n.a)({},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"react-native-开发调试与构建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#react-native-开发调试与构建","aria-hidden":"true"}},[t._v("#")]),t._v(" React Native 开发调试与构建")]),t._v(" "),e("h2",{attrs:{id:"项目初始化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目初始化","aria-hidden":"true"}},[t._v("#")]),t._v(" 项目初始化")]),t._v(" "),e("p",[t._v("React Native 官方提供了两种初始化方式，一种是通过 "),e("a",{attrs:{href:"https://github.com/react-community/create-react-native-app",target:"_blank",rel:"noopener noreferrer"}},[t._v("Create React Native App"),e("OutboundLink")],1),t._v(" 来安装，不需要安装 XCode 或者 Android  Studio。这种安装方式的要求是你的项目是一个全新的项目，之前没有任何的 native 代码。具体操作方式如下：")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g create-react-native-app\n$ create-react-native-app AwesomeProject\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cd")]),t._v(" AwesomeProject "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" start\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("p",[t._v("比较简单明了，但是笔者在操作过程中，"),e("code",[t._v("npm start")]),t._v(" 以后，根据提示选择启动模拟器后，一直无法连接上模拟器（模拟器已经启动成功），最终导致超时报错，如下：")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("Starting iOS...\nError: read ETIMEDOUT\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("在进行一些搜索后，可能是 "),e("a",{attrs:{href:"https://expo.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("expo"),e("OutboundLink")],1),t._v(" 下载超时，网上的解决办法都不起作用，这条路在本机没有走通。"),e("br"),t._v("\n该问题的相关 issue 参考："),e("a",{attrs:{href:"https://github.com/react-community/create-react-native-app/issues/107",target:"_blank",rel:"noopener noreferrer"}},[t._v('Hangs on "Starting simulator... '),e("OutboundLink")],1),t._v("，"),e("a",{attrs:{href:"https://github.com/react-community/create-react-native-app/issues/422",target:"_blank",rel:"noopener noreferrer"}},[t._v("Application not open on IOS simulator"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("另一种方式是通过 "),e("a",{attrs:{href:"https://www.npmjs.com/package/react-native-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("react-native-cli"),e("OutboundLink")],1),t._v(" 来进行初始化。使用这种安装方式初始化的项目会包含部分 native 代码。具体操作方式如下：")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ brew "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" watchman\n$ react-native init AwesomeProject\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cd")]),t._v(" AwesomeProject\n$ react-native run-ios\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("blockquote",[e("p",[t._v("watchman 为文件变更监听依赖")])]),t._v(" "),e("p",[t._v("针对于 android，由于需要使用的模拟器，需要安装 "),e("a",{attrs:{href:"https://developer.android.com/studio/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Android Studio"),e("OutboundLink")],1),t._v("，android SDK 和模拟器。操作"),e("a",{attrs:{href:"https://facebook.github.io/react-native/docs/getting-started#android-development-environment",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("p",[t._v("如果你的项目中包含 native 代码，推荐使用第二种方式进行开发。")]),t._v(" "),e("blockquote",[e("p",[t._v("以上两种初始化方式都有详细的文档说明，"),e("a",{attrs:{href:"https://facebook.github.io/react-native/docs/getting-started",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考链接"),e("OutboundLink")],1),t._v("。本文出于完整性考虑，简单罗列在此。")])]),t._v(" "),e("h2",{attrs:{id:"开发调试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开发调试","aria-hidden":"true"}},[t._v("#")]),t._v(" 开发调试")]),t._v(" "),e("p",[t._v("项目启动后，正常情况下，模拟器中应该显示如下效果："),e("br"),t._v(" "),e("img",{attrs:{src:"https://facebook.github.io/react-native/docs/GettingStartediOSSuccess.png",alt:""}})]),t._v(" "),e("p",[t._v("在 ios 模拟器中，通过 "),e("code",[t._v("⌘D")]),t._v(" 快捷键打开开发菜单，如下图："),e("br"),t._v(" "),e("img",{attrs:{src:"/images/2018/react-native-dev-build/ios-menu.jpg",alt:"IMAGE"}}),e("br"),t._v("\n根据菜单选择相应的开发调试能力。")]),t._v(" "),e("p",[t._v("在 android 模拟器中，通过 "),e("code",[t._v("⌘M")]),t._v(" 快捷键打开开发菜单，如下图："),e("br"),t._v(" "),e("img",{attrs:{src:"/images/2018/react-native-dev-build/android-menu.jpg",alt:"IMAGE"}})]),t._v(" "),e("p",[t._v("点击 JS 远程调试以后，默认会打开一个页面，可以 Chrome Devtools 来进行断点调试，按时不具备网络调试和组件结构调试能力。组件结构需要借助于 react-devtools 来实现，参考使用"),e("a",{attrs:{href:"https://facebook.github.io/react-native/docs/debugging",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("blockquote",[e("p",[t._v("注意，android 在有些情况下会出现无法连接调试器的情况，这是因为 android 默认情况下远程调试 js 启动的服务以 ip:port/debugger-ui 的链接打开，某些情况下会有网络问题导致打不开，在模拟器中打开调试工具，设置调试服务为 localhost:port 即可。")])]),t._v(" "),e("p",[t._v("经过笔者一段时间的开发调试和探索，提供另一个开发调试方案，"),e("a",{attrs:{href:"https://github.com/jhen0409/react-native-debugger",target:"_blank",rel:"noopener noreferrer"}},[t._v("React Native Debugger"),e("OutboundLink")],1),t._v("。"),e("br"),t._v("\n可以通过 HomeBrew 进行安装。")]),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ brew update "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" brew cask "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" react-native-debugger\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("打开后如图："),e("br"),t._v(" "),e("img",{attrs:{src:"/images/2018/react-native-dev-build/rndebugger.jpg",alt:"IMAGE"}}),t._v("\n从图中可以看到，RNDebugger 已经集成了组件结构，样式，js 调试等能力，类似于 Chrome Devtools。唯一不足的是没有网络调试能力，可以通过如下方式解决。"),e("br"),t._v("\n在应用的入口代码中，添加如下代码：")]),t._v(" "),e("div",{staticClass:"language-javascript line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// js 写法中声明代码直接删除")]),t._v("\ndeclare "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" any"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__DEV__"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("XMLHttpRequest "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("originalXMLHttpRequest "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("XMLHttpRequest"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FormData "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("originalFormData "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FormData"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Blob "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("originalBlob "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Blob"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FileReader "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("originalFileReader "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" global"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FileReader"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  fetch"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ensure to get the lazy property")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RNDebugger only")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" any"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__FETCH_SUPPORT__"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" any"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__FETCH_SUPPORT__"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("blob "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br")])]),e("p",[t._v("这样在 Network 页签中就可以看到网络请求了。具体原理"),e("a",{attrs:{href:"https://github.com/jhen0409/react-native-debugger/blob/master/docs/network-inspect-of-chrome-devtools.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"常用组件使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常用组件使用","aria-hidden":"true"}},[t._v("#")]),t._v(" 常用组件使用")]),t._v(" "),e("p",[t._v("在前端应用开发中，主要包括路由、列表、Form 组件、按钮等基本组件。在这些组件中，除了路由以外，在 React Native 官方都给了封装，可以直接使用，此处不再赘述，具体参考"),e("a",{attrs:{href:"https://facebook.github.io/react-native/docs/components-and-apis",target:"_blank",rel:"noopener noreferrer"}},[t._v("组件列表"),e("OutboundLink")],1),t._v("。"),e("br"),t._v("\nReact Native 官方推荐的路由组件是 "),e("a",{attrs:{href:"https://reactnavigation.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("React Navigation"),e("OutboundLink")],1),t._v("。我们前端常用的 React 路由是 "),e("a",{attrs:{href:"https://reacttraining.com/react-router/web/guides/philosophy",target:"_blank",rel:"noopener noreferrer"}},[t._v("React Router"),e("OutboundLink")],1),t._v("。经过试用和对比，个人建议使用 React Navigation。因为 React Navigation 是基于 Native 的封装，提供了很多平台相关的能力，比如切换动画、UI样式等，开发者不用再重复开发，可以更加专注于业务。")]),t._v(" "),e("h2",{attrs:{id:"应用打包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#应用打包","aria-hidden":"true"}},[t._v("#")]),t._v(" 应用打包")]),t._v(" "),e("p",[t._v("在应用开发完成后，需要构建应用包。这里官方文档中较为隐蔽，ios 打包"),e("a",{attrs:{href:"https://facebook.github.io/react-native/docs/running-on-device#building-your-app-for-production",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),e("OutboundLink")],1),t._v("，android 打包"),e("a",{attrs:{href:"https://facebook.github.io/react-native/docs/signed-apk-android",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),e("OutboundLink")],1),t._v("。"),e("br"),t._v("\n在 android 应用包构建过程中，gradle 编译可能需要配置翻墙代理，可以通过在 "),e("code",[t._v("~/.gradle/gradle.properties")]),t._v(" 配置如下代理：")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("systemProp.https.proxyPort=1087\nsystemProp.http.proxyHost=127.0.0.1\nsystemProp.https.proxyHost=127.0.0.1\nsystemProp.http.proxyPort=1087\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("p",[t._v("对应的 IP 和端口号为本地代理服务器。")])])},[],!1,null,null,null);a.default=s.exports}}]);