<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React Native 常见开发问题 | Bingooo.Tang 的日志</title>
    <meta name="description" content="React Native 常见开发问题汇总记录">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.45fd1eb4.css" as="style"><link rel="preload" href="/assets/js/app.1a92a99b.js" as="script"><link rel="preload" href="/assets/js/2.4bb95436.js" as="script"><link rel="preload" href="/assets/js/39.9a05368b.js" as="script"><link rel="preload" href="/assets/js/9.60a9ad14.js" as="script"><link rel="prefetch" href="/assets/js/10.ff19f3cc.js"><link rel="prefetch" href="/assets/js/11.e260adce.js"><link rel="prefetch" href="/assets/js/12.e1d4dc76.js"><link rel="prefetch" href="/assets/js/13.3780b65b.js"><link rel="prefetch" href="/assets/js/14.821eca39.js"><link rel="prefetch" href="/assets/js/15.947a489c.js"><link rel="prefetch" href="/assets/js/16.31117fc6.js"><link rel="prefetch" href="/assets/js/17.aa761a41.js"><link rel="prefetch" href="/assets/js/18.38e91cd9.js"><link rel="prefetch" href="/assets/js/19.2f0ddeb0.js"><link rel="prefetch" href="/assets/js/20.98a05b39.js"><link rel="prefetch" href="/assets/js/21.12bee07e.js"><link rel="prefetch" href="/assets/js/22.825b5c65.js"><link rel="prefetch" href="/assets/js/23.5a7523f8.js"><link rel="prefetch" href="/assets/js/24.d4db672e.js"><link rel="prefetch" href="/assets/js/25.9dc639ba.js"><link rel="prefetch" href="/assets/js/26.bb89ef52.js"><link rel="prefetch" href="/assets/js/27.9b952333.js"><link rel="prefetch" href="/assets/js/28.36b12119.js"><link rel="prefetch" href="/assets/js/29.b3fc89ab.js"><link rel="prefetch" href="/assets/js/3.914428ae.js"><link rel="prefetch" href="/assets/js/30.8403f552.js"><link rel="prefetch" href="/assets/js/31.3a71fc7c.js"><link rel="prefetch" href="/assets/js/32.f63547d0.js"><link rel="prefetch" href="/assets/js/33.30c37fb4.js"><link rel="prefetch" href="/assets/js/34.b1e97f3f.js"><link rel="prefetch" href="/assets/js/35.ab2a7a8c.js"><link rel="prefetch" href="/assets/js/36.5d422d5b.js"><link rel="prefetch" href="/assets/js/37.839e7d79.js"><link rel="prefetch" href="/assets/js/38.72e8bf2f.js"><link rel="prefetch" href="/assets/js/4.5c559b86.js"><link rel="prefetch" href="/assets/js/40.a8400673.js"><link rel="prefetch" href="/assets/js/41.ead2592b.js"><link rel="prefetch" href="/assets/js/42.2b99ba39.js"><link rel="prefetch" href="/assets/js/43.340f4287.js"><link rel="prefetch" href="/assets/js/44.6bf6391c.js"><link rel="prefetch" href="/assets/js/45.c33e2690.js"><link rel="prefetch" href="/assets/js/46.acfb4c4c.js"><link rel="prefetch" href="/assets/js/47.0d284677.js"><link rel="prefetch" href="/assets/js/48.7e5faf9d.js"><link rel="prefetch" href="/assets/js/49.70243ee5.js"><link rel="prefetch" href="/assets/js/5.4f064dd5.js"><link rel="prefetch" href="/assets/js/50.a70d1e3a.js"><link rel="prefetch" href="/assets/js/51.54705e9f.js"><link rel="prefetch" href="/assets/js/52.5e8b3d7e.js"><link rel="prefetch" href="/assets/js/53.03656bc8.js"><link rel="prefetch" href="/assets/js/54.d3b3024e.js"><link rel="prefetch" href="/assets/js/55.b8b66fcf.js"><link rel="prefetch" href="/assets/js/56.bcc27a01.js"><link rel="prefetch" href="/assets/js/57.dd12e611.js"><link rel="prefetch" href="/assets/js/6.8113e0b5.js"><link rel="prefetch" href="/assets/js/7.222800b2.js"><link rel="prefetch" href="/assets/js/8.84f16d44.js">
    <link rel="stylesheet" href="/assets/css/0.styles.45fd1eb4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Bingooo.Tang 的日志</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">博客</a></div><div class="nav-item"><a href="/tutorials/" class="nav-link">教程</a></div><div class="nav-item"><a href="/tools/" class="nav-link">工具</a></div> <a href="https://github.com/bingoootang" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">博客</a></div><div class="nav-item"><a href="/tutorials/" class="nav-link">教程</a></div><div class="nav-item"><a href="/tools/" class="nav-link">工具</a></div> <a href="https://github.com/bingoootang" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </aside> <main class="page"> <div class="content default"><h1 id="react-native-常见开发问题"><a href="#react-native-常见开发问题" aria-hidden="true" class="header-anchor">#</a> React Native 常见开发问题</h1> <p>在 React Native 开发过程中，经常会碰到一些重复的问题，但是由于间隔时间比较久，往往忘记了解决方法，造成重复工作。在这些问题中，有些工程问题可能随着 <a href="https://www.npmjs.com/package/react-native-cli" target="_blank" rel="noopener noreferrer">react-native-cli<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 脚手架的升级而得到解决，有些特性或者功能问题可能需要社区支持，有些可能是使用方法不对等。<br>
本文主要针对这些常见问题做一些整理和记录，方便后续查看。</p> <h2 id="工程问题"><a href="#工程问题" aria-hidden="true" class="header-anchor">#</a> 工程问题</h2> <h3 id="js-远程调试打不开"><a href="#js-远程调试打不开" aria-hidden="true" class="header-anchor">#</a> js 远程调试打不开</h3> <p>android 默认情况下远程调试js启动的服务以 ip:port/debugger-ui 的链接打开，某些情况下会有网络问题导致打不开，在模拟器中打开调试工具，设置调试服务为 localhost:port 即可。</p> <h3 id="在devtools-中查看网络请求"><a href="#在devtools-中查看网络请求" aria-hidden="true" class="header-anchor">#</a> 在devtools 中查看网络请求</h3> <ul><li>安装 react-native-debugger</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>brew update <span class="token operator">&amp;&amp;</span> brew cask <span class="token function">install</span> react-native-debugger
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>在应用入口处添加如下代码</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>declare <span class="token keyword">const</span> global<span class="token punctuation">:</span> any<span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>__DEV__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  global<span class="token punctuation">.</span>XMLHttpRequest <span class="token operator">=</span> global<span class="token punctuation">.</span>originalXMLHttpRequest <span class="token operator">||</span> global<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">;</span>
  global<span class="token punctuation">.</span>FormData <span class="token operator">=</span> global<span class="token punctuation">.</span>originalFormData <span class="token operator">||</span> global<span class="token punctuation">.</span>FormData<span class="token punctuation">;</span>
  global<span class="token punctuation">.</span>Blob <span class="token operator">=</span> global<span class="token punctuation">.</span>originalBlob <span class="token operator">||</span> global<span class="token punctuation">.</span>Blob<span class="token punctuation">;</span>
  global<span class="token punctuation">.</span>FileReader <span class="token operator">=</span> global<span class="token punctuation">.</span>originalFileReader <span class="token operator">||</span> global<span class="token punctuation">.</span>FileReader<span class="token punctuation">;</span>
  
  fetch<span class="token punctuation">;</span> <span class="token comment">// Ensure to get the lazy property</span>

  <span class="token comment">// RNDebugger only</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>window <span class="token keyword">as</span> any<span class="token punctuation">)</span><span class="token punctuation">.</span>__FETCH_SUPPORT__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>window <span class="token keyword">as</span> any<span class="token punctuation">)</span><span class="token punctuation">.</span>__FETCH_SUPPORT__<span class="token punctuation">.</span>blob <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="构建成功，但是在模拟器中无法显示页面"><a href="#构建成功，但是在模拟器中无法显示页面" aria-hidden="true" class="header-anchor">#</a> 构建成功，但是在模拟器中无法显示页面</h3> <p>模拟器中显示如下错误信息，</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>unable to load script from assets index.android.bundle
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>解决方法：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> android/app/src/main
react-native bundle --platform android --dev <span class="token boolean">false</span> --entry-file index.js --bundle-output android/app/src/main/index.android.bundle --assets-dest android/app/src/main/res
react-native run-android
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="功能问题"><a href="#功能问题" aria-hidden="true" class="header-anchor">#</a> 功能问题</h2> <h3 id="使用视频"><a href="#使用视频" aria-hidden="true" class="header-anchor">#</a> 使用视频</h3> <p>可以引入 react-native-video 这个包，安装完成后，需要执行 <code>react-native link react-native-video</code> 链接相关库。如果报一些包找不到的错，且路径都是 maven 库的话，可以在 android/build.grade 中加入如下设置。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>maven {
    url 'https://maven.google.com'
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>配置完成后如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>allprojects {
    repositories {
        mavenLocal()
        jcenter()
        maven {
            url 'https://maven.google.com'
        }
        maven {
            // All of React Native (JS, Obj-C sources, Android binaries) is installed from npm
            url &quot;$rootDir/../node_modules/react-native/android&quot;
        }
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="安卓端动图支持"><a href="#安卓端动图支持" aria-hidden="true" class="header-anchor">#</a> 安卓端动图支持</h3> <p>react-native在安卓端默认是不支持GIF动图的，根据文档提示，需要在android/app/build.gradle文件中根据需要手动添加以下模块</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dependencies {
  // If your app supports Android versions before Ice Cream Sandwich (API level 14)
  compile 'com.facebook.fresco:animated-base-support:1.9.0'

  // For animated GIF support
  compile 'com.facebook.fresco:animated-gif:1.9.0'

  // For WebP support, including animated WebP
  compile 'com.facebook.fresco:animated-webp:1.9.0'
  compile 'com.facebook.fresco:webpsupport:1.9.0'

  // For WebP support, without animations
  compile 'com.facebook.fresco:webpsupport:1.9.0'
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>注意，不同的RN版本，需要的 <code>com.facebook.fresco</code> 的版本号是不一样的。请查看对应 RN 版本的文档，获取正确的 <code>com.facebook.fresco</code> 的版本号。</p> <h2 id="其他问题"><a href="#其他问题" aria-hidden="true" class="header-anchor">#</a> 其他问题</h2> <h3 id="statusbar-高度"><a href="#statusbar-高度" aria-hidden="true" class="header-anchor">#</a> StatusBar 高度</h3> <p>StatusBar 不会占据位置，只能改变系统状态栏的颜色等属性，需要在样式中空出状态栏的高度，否则系统状态栏会覆盖在页面上造成遮挡。<br>
获取状态栏的高度方法：</p> <ul><li>安卓： StatusBar.currentHeight</li> <li>IOS：iphoneX 为 44，其他为 20</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">5/13/2019, 3:05:16 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.1a92a99b.js" defer></script><script src="/assets/js/2.4bb95436.js" defer></script><script src="/assets/js/39.9a05368b.js" defer></script><script src="/assets/js/9.60a9ad14.js" defer></script>
  </body>
</html>
